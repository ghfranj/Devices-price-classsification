# Devices Price Classification System - Python Project

## Overview

This Python project aims to predict the price range of mobile devices based on their specifications. It includes data preparation, model training using TensorFlow, and a Flask API for making predictions.

## Project Structure

```
PythonProject/
│
├── data/
│   ├── X_test_prepared.csv     # Preprocessed test data after data preparation
│   ├── X_train_prepared.csv    # Preprocessed training data after data preparation
│   ├── test - test.csv         # Original test data
│   └── train - train.csv       # Original training data
│
├── notebooks/
│   ├── best_params.json        # JSON file containing best hyperparameters for the model
│   ├── data_preparation.ipynb  # Jupyter notebook for data preparation steps
│   ├── exploratory_data_analysis.ipynb # Jupyter notebook for data exploration
│   └── model_training.ipynb    # Jupyter notebook for model training and evaluation
│
├── saved_model/
│   └── best_model.h5           # Trained model saved in HDF5 format
│
├── src/
│   ├── __pycache__/            # Cached Python files (generated by Python interpreter)
│   ├── data_preparation.py     # Script for data loading, cleaning, and feature engineering
│   ├── flask_app.py            # Flask API script for serving predictions
│   ├── model.py                # TensorFlow model definition and training script
│   ├── predict.py              # Script to make predictions using trained model
│   ├── train.py                # Script to train the TensorFlow model
│   ├── app.py                  # Entry point for Flask application
│   └── main.py                 # Main script to orchestrate data preparation, training, and serving
│
└── requirements.txt            # Python dependencies required for the project
```

## Detailed Components

### 1. Data Preparation (`src/data_preparation.py`)

This module handles loading, cleaning, and preparing the dataset for model training.

- **Dependencies:** `pandas`, `numpy`, `scikit-learn`

#### Functions:

- `load_data(train_path, test_path)`: Loads the training and test datasets from CSV files.
- `handle_missing_values(df)`: Imputes missing values in the dataset using mean imputation.
- `feature_engineering(df)`: Applies feature engineering techniques (e.g., creating new features like pixel density).
- `scale_features(train_df, test_df)`: Scales numerical features using `StandardScaler`.
- `prepare_data(train_path, test_path)`: Main function to prepare data, integrating the above functions.

### 2. Model Training (`src/model.py`)

This module defines, trains, and evaluates the TensorFlow model for predicting device price ranges.

- **Dependencies:** `tensorflow`, `numpy`

#### Functions:

- `train(X_train, y_train, validation_data, epochs, batch_size)`: Trains the neural network model using TensorFlow.
- `evaluate(X_test, y_test)`: Evaluates the model performance on test data.
- `plot_training_history()`: Plots the training history (loss and accuracy) of the model.
- `save_model(model_save_path)`: Saves the trained model to a specified path.

### 3. Flask API (`src/flask_app.py`)

This script sets up a Flask API endpoint to serve predictions using the trained model.

- **Dependencies:** `Flask`, `tensorflow`, `pandas`

#### Endpoints:

- `GET /`: Home endpoint returning a welcome message.
- `POST /predict_single`: Endpoint to predict price range for a single device.
- `POST /predict_group`: Endpoint to predict price ranges for multiple devices.

### 4. Main Orchestration (`src/main.py`)

This script orchestrates the entire pipeline from data preparation to model training and serving predictions.

- **Dependencies:** `os`, `pandas`, `numpy`, `src/data_preparation`, `src/model`, `src/flask_app`

#### Steps:

- Loads and prepares data (`prepare_data` function).
- Trains the TensorFlow model (`train` function).
- Saves the trained model to `saved_model/best_model.h5`.
- Initializes and runs the Flask API (`src/app.py`).

## Running the Project

### Prerequisites

- Python 3.6 or higher
- Install dependencies using `pip install -r requirements.txt`

### Steps to Run

1. **Data Preparation and Model Training:**

   ```bash
   python src/main.py
   ```

   - This will prepare the data, train the TensorFlow model, and save it.

2. **Run Flask API:**

   ```bash
   python src/app.py
   ```

   - The Flask API will start running locally (`http://127.0.0.1:5000`).

## Usage

- **Predict Single Device:**

  ```bash
  curl -X POST -H "Content-Type: application/json" -d '{
    "battery_power": 1500,
    "blue": 1,
    "clock_speed": 2.0,
    "dual_sim": 1,
    "fc": 5,
    "four_g": 1,
    "int_memory": 16,
    "m_dep": 0.5,
    "mobile_wt": 120,
    "n_cores": 4,
    "pc": 12,
    "px_height": 800,
    "px_width": 1200,
    "ram": 2048,
    "sc_h": 10,
    "sc_w": 5,
    "talk_time": 20,
    "three_g": 1,
    "touch_screen": 1,
    "wifi": 1
  }' http://127.0.0.1:5000/predict_single
  ```

  Example Response:

  ```json
  {
    "prediction": 2,
    "probability": [0.05, 0.10, 0.70, 0.15]
  }
  ```

- **Predict Multiple Devices:**

  ```bash
  curl -X POST -H "Content-Type: application/json" -d '[{
    "battery_power": 1500,
    "blue": 1,
    ...
  },{
    "battery_power": 1800,
    "blue": 1,
    ...
  }]' http://127.0.0.1:5000/predict_group
  ```

  Example Response:

  ```json
  {
    "predictions": [2, 3]
  }
  ```

## Conclusion
A final flask app was built with the best resulted model after applying a grid search for hyperparameter tuning. 
